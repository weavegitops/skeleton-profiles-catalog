apiVersion: weave.works/v1alpha1
kind: ProfileDefinition
metadata:
  name: kube-prometheus-stack
spec:
  description: Profile for deploying prometheus chart
  maintainer: weaveworks
  prerequisites:
    - "kubernetes 1.19"
  artifacts:
    - name: kube-prometheus-stack
      chart:
        url: https://prometheus-community.github.io/helm-charts
        name: kube-prometheus-stack
        version: "18.0.12"
        defaultValues: |
          grafana:
            ingress:
              path: /grafana/?(.*)
              enabled: true
              annotations:
                kubernetes.io/ingress.class: mccp-nginx
                nginx.ingress.kubernetes.io/rewrite-target: /$1
                nginx.ingress.kubernetes.io/use-regex: "true"
          grafana.ini:
            server:
              root_url: http://localhost:3000/grafana